# [Graph Convolutional Neural Networks for Web-Scale Recommender Systems](https://arxiv.org/pdf/1806.01973.pdf)

## Key points
* GCN - PinSage which combines efficient random walks and graph convolutions to generate embeddings of user-item pairs
* Embeddings incorportage graph structure as well as node feature information
* Trained using pairwaise ranking loss function and able to handle sparsity by using negative sampling.
  * Negative sampling is used to generate negative examples for the pairwise ranking loss function.
  * These examples are generated by randomly sampling items that are not connected to the user in the graph structure of the data.
* Pairwise ranking loss function: 
   - 2 parts - positive: loss for the correct ordering of the items
   - 2 parts - negative: loss for the incorrect ordering of the items
   - Total loss: sum of both losses
* Trained on 3 billion nodes representing pins and boards and 18 billion edges - according to A/B tests, PinSage generates higher quality reccomendations than other DL alternatives.

<img width="693" alt="Screenshot 2022-07-17 at 22 52 44" src="https://user-images.githubusercontent.com/598891/179426176-83585a06-8b3e-4185-89b1-4b78fc2a821f.png">

* Importance pooling: feature information is aggregated from local neighborhoods in the graph - but we introduce a method to weigh the importance of node features, based upon random-walk similarty measures.

<img width="698" alt="Screenshot 2022-07-17 at 23 02 11" src="https://user-images.githubusercontent.com/598891/179426413-8f6d5fe0-ebd0-46c5-8bce-3ddcfeb6c6d9.png">

Loss: <img width="344" alt="Screenshot 2022-07-17 at 23 03 52" src="https://user-images.githubusercontent.com/598891/179426477-01ed1901-36cc-46c0-8eef-8193ede8b1c6.png">
